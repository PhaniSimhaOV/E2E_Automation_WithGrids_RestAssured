pipeline {
    agent any
tools{
maven 'MAVEN'
}

    stages {
        stage('Checkout Code') {
            steps {
                script {
                     checkout scmGit(branches: [[name: '*/OEM_Anjali.M']], extensions: [], userRemoteConfigs: [[credentialsId: '1b8be9aa-d3f6-4295-94bd-99f752461e51', url: 'https://github.com/LazySaif20/E2E_Automation_WithGrids_RestAssured.git']])

                }
            }
        }


        stage('Run Automation Scripts (Cucumber Tests)') {
            steps {
                script {
                    sh "mvn test -Dcucumber.options='--plugin json:${env.REPORTS_DIR}/cucumber.json'"
                }
            }
        }

        stage('Archive Cucumber Reports') {
            steps {
                script {
                    // Archive the generated Cucumber JSON reports
                    archiveArtifacts artifacts: "${env.REPORTS_DIR}/**/*", allowEmptyArchive: true
                }
            }
        }
    }

    post {
        always {
            // Always run this block, whether success or failure
            junit '**/target/surefire-reports/*.xml'

        }
    }
}
